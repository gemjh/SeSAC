FROM python:3.9-slim

WORKDIR /app

# 시스템 패키지 설치
RUN apt-get update && apt-get install -y \
    libsndfile1 \
    && rm -rf /var/lib/apt/lists/*

# Python 패키지 설치
RUN pip install --no-cache-dir tensorflow==2.13.0 librosa numpy

# 모델과 스크립트 복사
COPY models/talk_clean/ /app/

# 환경변수 설정
ENV TF_CPP_MIN_LOG_LEVEL=3
ENV CUDA_VISIBLE_DEVICES=-1
ENV PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python

# 스크립트 실행
ENTRYPOINT ["python", "predict_script.py"]